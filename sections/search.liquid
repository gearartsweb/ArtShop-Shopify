{{ 'critical.css' | asset_url | stylesheet_tag }}

<div class="page-width" style="padding: 60px 20px;">
  <div class="search-header" style="text-align: center; margin-bottom: 50px;">
    <h1 class="collection-title" style="font-size: 1.5rem; font-weight: 300; text-transform: uppercase; letter-spacing: 2px;">
      {% if search.performed %}
        {% if search.results_count == 1 %}
          1 Result for "{{ search.terms }}"
        {% else %}
          {{ search.results_count }} Results for "{{ search.terms }}"
        {% endif %}
      {% else %}
        Search Our Studio
      {% endif %}
    </h1>

    {% comment %} Search bar on the results page for quick adjustments {% endcomment %}
    <form action="{{ routes.search_url }}" method="get" role="search" style="max-width: 500px; margin: 30px auto; display: flex; gap: 10px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
      <input 
        type="search" 
        name="q" 
        value="{{ search.terms | escape }}" 
        placeholder="Search again..." 
        style="flex: 1; border: none; outline: none; font-family: inherit; font-size: 14px; text-transform: uppercase; letter-spacing: 1px;"
      >
      <button type="submit" style="background: none; border: none; font-weight: 600; cursor: pointer; font-size: 12px; letter-spacing: 1px;">GO</button>
    </form>
  </div>

  <div class="collection-layout-wrapper">
    {% comment %} Sidebar with Dynamic Filters {% endcomment %}
    <aside class="collection-sidebar">
      {% render 'facets', results: search %}
    </aside>

    <main class="collection-main">
      {% paginate search.results by 32 %}
        {% if search.performed %}
          <div class="studio-grid">
            {% for item in search.results %}
              {% comment %} 
                Ensure we only show products. 
                If you want to show pages/articles, we would need a different card style.
              {% endcomment %}
              {% if item.object_type == 'product' %}
                {% render 'product-card', product: item %}
              {% endif %}
            {% else %}
              <p style="text-align: center; grid-column: 1 / -1; padding: 40px; color: #666;">
                No items matched your search for "{{ search.terms }}".
              </p>
            {% endfor %}
          </div>
        {% endif %}

        {% if paginate.pages > 1 %}
          <div class="pagination" style="margin-top: 50px; text-align: center; display: flex; justify-content: center; gap: 15px;">
            {{ paginate | default_pagination }}
          </div>
        {% endif %}
      {% endpaginate %}
    </main>
  </div>
</div>

<style>
  /* Layout Architecture - Matches your Collection Page */
  .collection-layout-wrapper { 
    display: flex; 
    gap: 40px; 
    max-width: 1400px; 
    margin: 0 auto; 
  }
  
  .collection-sidebar { 
    flex: 0 0 220px; 
    border-right: 1px solid #eee; 
    padding-right: 20px; 
  }
  
  .collection-main { 
    flex: 1; 
  }

  /* The Studio Grid */
  .studio-grid { 
    display: grid; 
    grid-template-columns: repeat(4, 1fr); 
    gap: 25px; 
  }

  /* Mobile Responsiveness */
  @media (max-width: 1200px) {
    .studio-grid { grid-template-columns: repeat(3, 1fr); }
  }

  @media (max-width: 768px) {
    .collection-layout-wrapper { flex-direction: column; }
    .collection-sidebar { display: none; } /* Hide sidebar on mobile to save space */
    .studio-grid { grid-template-columns: repeat(2, 1fr); }
    .collection-title { font-size: 1.2rem; }
  }

  /* Ensure the facets snippet styling is supported */
  .facet-details { border-bottom: 1px solid #eee; padding: 15px 0; }
  .facet-details summary { cursor: pointer; font-size: 12px; text-transform: uppercase; font-weight: 600; list-style: none; }
  .facet-details summary::-webkit-details-marker { display: none; }
</style>

{% schema %}
{
  "name": "Search Results",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "min": 8,
      "max": 48,
      "step": 4,
      "default": 24,
      "label": "Products per page"
    }
  ]
}
{% endschema %}