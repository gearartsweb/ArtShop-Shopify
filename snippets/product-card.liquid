<div class="studio-product-card product-card-{{ product.id }} {% unless product.available %}product-card--sold-out{% endunless %}">
  <a href="{{ product.url }}" style="text-decoration: none; color: inherit;">
    <div class="image-frame" style="position: relative;">
      
      {% comment %} SOLD OUT BADGE {% endcomment %}
      <span class="sold-out-badge" {% if product.available %}style="display:none"{% endif %}>SOLD OUT</span>

      <img 
        src="{{ product.featured_image | image_url: width: 400 }}" 
        alt="{{ product.featured_image.alt | escape }}"
        loading="lazy"
        width="{{ product.featured_image.width }}"
        height="{{ product.featured_image.height }}"
        class="grid-img"
      >

      {% form 'product', product, class: 'product-card-form' %}
        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" class="selected-variant-id">
        <input type="hidden" name="quantity" value="1">
        
        <button type="submit" class="quick-add-btn {% unless product.available %}disabled{% endunless %}" {% unless product.available %}disabled{% endunless %}>
          {% if product.available %}ADD TO BAG{% else %}UNAVAILABLE{% endif %}
        </button>
      {% endform %}
    </div>

    <div class="product-info">
      <p class="brand-name">{{ product.vendor }}</p>
      <h3 class="product-title">{{ product.title }}</h3>
      
      <p class="product-price" data-base-price="{{ product.price | money }}">
        {% if product.available %}
          {{ product.price | money }}
        {% else %}
          <span style="text-decoration: line-through; color: #999;">{{ product.price | money }}</span>
        {% endif %}
      </p>

      {% comment %} === NEW: VARIANT PILLS (Sizes/Colors) === {% endcomment %}
      {% if product.variants.size > 1 %}
        <div class="card-variant-selector" style="display: flex; gap: 5px; flex-wrap: wrap; margin-top: 8px;">
          {% for variant in product.variants %}
            <button type="button" 
              class="variant-pill {% if product.selected_or_first_available_variant.id == variant.id %}active{% endif %}"
              data-variant-id="{{ variant.id }}"
              data-variant-price="{{ variant.price | money }}"
              data-variant-available="{{ variant.available }}"
              data-variant-image="{{ variant.featured_image | image_url: width: 400 }}"
              onclick="selectGridVariant(this, '{{ product.id }}')"
              style="font-size: 10px; padding: 3px 8px; border: 1px solid #ddd; background: #fff; cursor: pointer; border-radius: 2px;">
              {{ variant.title | replace: 'Size ', '' | replace: 'Color ', '' }}
            </button>
          {% endfor %}
        </div>
      {% endif %}
      
    </div>
  </a>
</div>